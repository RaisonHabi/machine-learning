## 1.矩阵分解用于推荐算法要解决的问题
在推荐系统中，我们常常遇到的问题是这样的，我们有很多用户和物品，也有少部分用户对少部分物品的评分，我们希望预测目标用户对其他未评分物品的评分，进而将评分高的物品推荐给目标用户。比如下面的用户物品评分表：

对于每个用户，我们希望较准确的预测出用户对未评分物品的评分。对于这个问题我们有很多解决方法，本文我们关注于用矩阵分解的方法来做。如果将m个用户和n个物品对应的评分看做一个矩阵𝑀，我们希望通过矩阵分解来解决这个问题。
## 2. 传统的奇异值分解SVD用于推荐
此时可以将这个用户物品对应的𝑚×𝑛矩阵𝑀进行SVD分解，并通过选择部分较大的一些奇异值来同时进行降维，也就是说矩阵𝑀此时分解为：𝑀𝑚×𝑛=𝑈𝑚×𝑘Σ𝑘×𝑘𝑉𝑇𝑘×𝑛

其中k是矩阵𝑀中较大的部分奇异值的个数，一般会远远的小于用户数和物品数。

如果我们要预测第i个用户对第j个物品的评分𝑚𝑖𝑗,则只需要计算𝑢𝑇𝑖Σ𝑣𝑗即可。

通过这种方法，我们可以将评分表里面所有没有评分的位置得到一个预测评分。通过找到最高的若干个评分对应的物品推荐给用户。
### 2.1 评分矩阵中的缺失值补全
可以看出这种方法简单直接，似乎很有吸引力。但是有一个很大的问题我们忽略了，**就是SVD分解要求矩阵是稠密的，也就是说矩阵的所有位置不能有空白**。    
有空白时我们的𝑀是没法直接去SVD分解的。大家会说，如果这个矩阵是稠密的，那不就是说我们都已经找到所有用户物品的评分了嘛，那还要SVD干嘛!   
的确，这是一个问题，**传统SVD采用的方法是对评分矩阵中的缺失值进行简单的补全，比如用全局平均值或者用用户物品平均值补全，得到补全后的矩阵。接着可以用SVD分解并降维**。

虽然有了上面的补全策略，我们的传统SVD在推荐算法上还是较难使用。因为我们的用户数和物品一般都是超级大，随便就成千上万了。  
这么大一个矩阵做SVD分解是非常耗时的。那么有没有简化版的矩阵分解可以用呢？我们下面来看看实际可以用于推荐系统的矩阵分解。
## 3、 FunkSVD算法用于推荐
**FunkSVD是在传统SVD面临计算效率问题时提出来的，既然将一个矩阵做SVD分解成3个矩阵很耗时，同时还面临稀疏的问题，那么我们能不能避开稀疏问题，同时只分解成两个矩阵呢？**    
也就是说，现在期望我们的矩阵𝑀这样进行分解：𝑀𝑚×𝑛=𝑃𝑇𝑚×𝑘𝑄𝑘×𝑛   

我们知道SVD分解已经很成熟了，但是FunkSVD如何将矩阵𝑀分解为𝑃和𝑄呢？

**这里采用了线性回归的思想。我们的目标是让用户的评分和用矩阵乘积得到的评分残差尽可能的小，也就是说，可以用均方差作为损失函数，来寻找最终的𝑃和𝑄**。

对于某一个用户评分𝑚𝑖𝑗，如果用FunkSVD进行矩阵分解，则对应的表示为𝑞𝑇𝑗𝑝𝑖，采用均方差做为损失函数，则我们期望(𝑚𝑖𝑗−𝑞𝑇𝑗𝑝𝑖)2尽可能的小，如果考虑所有的物品和样本的组合，则我们期望最小化下式：
∑𝑖,𝑗(𝑚𝑖𝑗−𝑞𝑇𝑗𝑝𝑖)2

只要我们能够最小化上面的式子，并求出极值所对应的𝑝𝑖,𝑞𝑗，则我们最终可以得到矩阵𝑃和𝑄，那么对于任意矩阵𝑀任意一个空白评分的位置，我们可以通过𝑞𝑇𝑗𝑝𝑖计算预测评分。很漂亮的方法！

## 4. BiasSVD算法用于推荐
在FunkSVD算法火爆之后，出现了很多FunkSVD的改进版算法。其中BiasSVD算是改进的比较成功的一种算法。  
**BiasSVD假设评分系统包括三部分的偏置因素**：一些和用户物品无关的评分因素，用户有一些和物品无关的评分因素，称为用户偏置项。而物品也有一些和用户无关的评分因素，称为物品偏置项。这其实很好理解。比如一个垃圾山寨货评分不可能高，自带这种烂属性的物品由于这个因素会直接导致用户评分低，与用户无关。

## 5. SVD++算法用于推荐
SVD++算法在BiasSVD算法上进一步做了增强，这里它**增加考虑用户的隐式反馈**。好吧，一个简单漂亮的FunkSVD硬是被越改越复杂。

对于某一个用户i，它提供了隐式反馈的物品集合定义为𝑁(𝑖), 这个用户对某个物品j对应的隐式反馈修正的评分值为𝑐𝑖𝑗, 那么该用户所有的评分修正值为∑𝑠∈𝑁(𝑖)𝑐𝑖𝑠。  
一般我们将它表示为用𝑞𝑇𝑠𝑦𝑖形式，则加入了隐式反馈项以后的优化目标函数𝐽(𝑝,𝑞)是这样的:
## 6. 矩阵分解推荐方法小结
FunkSVD将矩阵分解用于推荐方法推到了新的高度，在实际应用中使用也是非常广泛。当然矩阵分解方法也在不停的进步，目前张量分解和分解机方法是矩阵分解推荐方法今后的一个趋势。

**优点：**  
对于矩阵分解用于推荐方法本身来说，它**容易编程实现，实现复杂度低，预测效果也好，同时还能保持扩展性**。这些都是它宝贵的优点。

**缺点：**   
当然，矩阵分解方法**有时候解释性还是没有基于概率的逻辑回归之类的推荐算法好，不过这也不影响它的流形程度**。  

小的推荐系统用矩阵分解应该是一个不错的选择。大型的话，则矩阵分解比起现在的深度学习的一些方法不占优势。

 

&nbsp;
## reference
[矩阵分解在协同过滤推荐算法中的应用](https://www.cnblogs.com/pinard/p/6351319.html)
