## 定义
卡方检验属于**非参数检验**，由于非参检验不存在具体参数和总体正态分布的假设，所以有时被称为**自由分布检验**。

参数和非参数检验**最明显的区别是它们使用数据的类型**。

非参检验通常将被试分类，如民主党和共和党，这些分类涉及名义量表或顺序量表，无法计算平均数和方差。

卡方检验分为**拟合度的卡方检验和卡方独立性检验**。

&nbsp;

## 拟合度的卡方检验
**定义**:主要使用样本数据检验总体分布形态或比例的假说。测验决定所获得的的样本比例与虚无假设中的总体比例的拟合程度如何。

拟合度的卡方检验又叫最佳拟合度的卡方检验，为何取名“最佳拟合”？这是因为最佳拟合度的卡方检验的目的是比较数据（实际频数）与虚无假设。确定数据如何拟合虚无假设指定的分布，因此取名“最佳拟合”。

关于拟合度的卡方检验有一些翻译上的区别，其实表达的是一个意思：  
**拟合度的卡方检验=卡方拟合优度检验=最佳拟合度卡方检验**

以下统称：卡方拟合优度检验  
卡方统计的公式： [公式]（见参考1）  
公式中O代表observation，即实际频数；E代表Expectation，即期望频数。  
为什么要在求和之前除以 [公式] ?  
原因： [公式] 与 [公式] 的差距是相对较大还是较小，取决于期望频数的大小

&nbsp;

示例：  
我们用几个例子来区分这两种卡方检验：  
> 对于可口可乐公司的两个领导品牌，大多数美国人喜欢哪一种？  
公司采用了新的网页页面B，相较于旧版页面A，网民更喜欢哪一种页面？

以上两个例子属于拟合度的卡方检验，原因在于它们都是有关总体比例的问题。我们只是将个体分类，并想知道每个类别中的总体比例。它检验的内容**仅涉及一个因素多项分类的计数资料，检验的是单一变量在多项分类中实际观察次数分布与某理论次数是否有显著差异**。

&nbsp;

## 卡方独立性检验
卡方独立性检验是用于**两个或两个以上因素多项分类的计数资料分析，即研究两类变量之间（以列联表形式呈现）的关联性和依存性，或相关性、独立性、交互作用性**。

卡方独立性检验的虚无假设指所测量的两个变量之间是独立的，即对于每个个体，所得到的一个变量值与另一个变量的值是不相关的。

同样，我们通过例子来区分卡方独立性检验和卡方拟合优度检验  
Example:研究人员正在研究学习成绩和自尊之间的关系。样本为n=150名10岁的儿童，每名被试均根据学习成绩和自尊水平分类。下表显示了该例中的频率分布和实际频数。

&nbsp;

## 总结
可以看出两种不同的卡方检验中，一种用于不同水平的单一分类变量，另一种用于不同水平的多类别变量。

在上例中，存在两个分类变量（学习成绩、自尊），每个变量含有不同水平（学习成绩有高低两个水平、自尊有高中低三个水平）。而在卡方拟合优度的例子中，我们只有一个分类变量（网页），该变量含有新旧两个水平。

卡方独立性检验的公式和卡方拟合优度相同，**自由度为：df=(R-1)(C-1)**  
其中，R为行数row，C为列数column

&nbsp;

## 卡方值计算
假设总频数为n，单元格内的期望频数为E，那么选择规则如下：  
> 当n大于等于40，且E大于5时，看皮尔逊卡方值即可；  
当n大于等于40，且E小于5且大于1时，选择连续性修正值；  
当n小于40，或E小于1时，选择费舍尔精确检验结果；  

**Pearson卡方**  
卡方检验最基本的就是Pearson卡方，它的计算公式大家都非常熟悉：(见参考2)

当总频数n大于等于40，且所有单元格内的期望频数E都大于等于5时，2*2四格表的卡方检验结果直接选择Pearson卡方值作为检验结果即可。但是，如果最终的Pearson卡方检验的检验概率值p与显著性水平α（0.1、0.05、0.01）非常接近时，应该选择Fisher精确检验值作为检验结果。

**连续性修正**  
对于总频数n>=40，但单元格中有期望频数1=<E<5时，2*2四格表的卡方检验结果应该选择连续型修正的结果，进行修正的原因上面已经解释，这是由卡方检验原理及卡方分布性质决定的。连续型修正公式如下：

当然，这种频数情况也可以直接选择Fisher精确检验结果作为最终结果。  
**Fisher精确检验**  
当2*2四格表中，有单元格的期望频数E<1，或总频数n<40时，直接用Pearson卡方值作为检验结果就不够准确和灵敏了。原因其实很好理解，样本总频数n小于40，频数分布结果有很大的可能性不具有代表性；单元格内的期望频数小于1，这有可能是由于样本频数数据不够多而导致的小概率事件，并没有反应总体的频数分布情况。



&nbsp;

## reference
[卡方检验（Chi-Squared Test）](https://zhuanlan.zhihu.com/p/56423752)    
[如何学习和理解卡方检验？](https://zhuanlan.zhihu.com/p/49218072)
