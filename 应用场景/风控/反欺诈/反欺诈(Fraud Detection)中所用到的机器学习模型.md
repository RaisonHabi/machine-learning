## 1
### 1.1 反欺诈分类：
第一层是人机识别，做不好这点，我们也许永远不知道一切的背后是一只狗，这一层是最基础能力，因为是纯机器操作，一旦突破风险极高，防御的技术含量也较高。OK已经知道是个人了，那是否是本人呢？

第二层是本人识别，盗号、盗卡等都属于这个层面，会对用户的核心价值和资产造成不菲损失。好的已经知道是本人在操作了，那是否是好人呢？

第三层，好人识别，还款的能力和意愿如何？是不是厂商不希望吸引过来的、只想占优惠活动便宜的低质用户？

其中一二层的对抗是最为激烈的，因为背后有数以百万计的黑灰产自然人，在追逐赤裸裸的利益，一边是黑产专业工具技术，做到单点突破就能获利，一边是反欺诈团队或公司能力，以安全策略模型来结一张风控网络。

### 1.2反欺诈方法
名单，规则策略，有监督，无监督，从弱到强？  
恐怕未必，标准是，什么好用用什么。

详细一点，我们习惯用准确率、召回率来衡量反欺诈方法质量，但这只是一个静态切片，黑产会动态变化，所以还要加入及时性和对抗性的指标一起来评估，前者衡量我们变化的成本和速度，后者衡量我们的每次变化被对方破解并绕过的成本和速度。

所以：
```
1.名单准召率和对抗性都很差，及时性确实高但又有什么用呢？弃之。
2.规则策略准召率尚可，及时性也算还行，就是对抗性偏弱。
3.有监督准召率能做到现有数据样本质量能达到的极限（充分调优的情况下），对抗性一般也不错（如gbm类），但及时性较差，标注和调优成本高。
4.无监督很少单独使用，一般结合有监督和规则一起，这种方案召回率尤其好，可以发现未知恶意，对抗性OK，及时性也会比有监督稍好，
毕竟降低了标注成本，有点问题的是技术门槛较高，做不好反蚀把米，roi很低。

怎么选？按照公司发展的不同阶段，掺合着来，成长期公司主1+2，准大厂一般还会加入适量3，2和3的比例视情况调整，一般7:3，是否加4视对抗情况和pr需求而定。
```


&nbsp;
## 2
欺诈行为相对多变复杂，在实际业务场景中通常会针对不同的欺诈类型和应用场景，选取合适的数据进行建模分析。

常用的数据类型有多维数据，关系网络，文本，序列等。其中，关于多维数据的异常检测可以找到许多相关资料，因此这里我们更多介绍一些关系网络、文本、序列相关的反欺诈模型。
### 2.1 关系网络
**图模型**是在反欺诈领域中广泛应用的一类模型。通过用户注册、激活、登录、下单等环节收集到的账户、设备信息，我们可以构建出用户间不同的关系网络，从中发现欺诈的迹象和线索。

其中一种使用这些关系网络的方法是，识别网络中异常的网络结构和社群。常用的社群挖掘方法有Walktrap, InfoMap, FastGreedy 等，这类模型通过识别紧密关联的社群结构找出潜在的欺诈客群，通常在刷单识别和套现识别的场景中有非常高的准确度。

另一种思路是通过好坏用户的网络关系进行传播，可以使用标签传播算法(Label Propagation)，传染病学模型(SIR Model), 以及概率图模型(MRF, CRF等)。感兴趣的知友可以参考今年ASONAM上的Graph assisted semi supervised learning for fraudulent detection (下载链接)，文章详细介绍了如何使用"用户-商户"网络进行准确的欺诈推断。

### 2.2 文本挖掘
**文本挖掘在电商场景中较为常用**。通过使用主题模型（LSA, LDA，FastText,Word2Vec等），可以准确的识别异常的套现黑中介的收货地址，或者通过挖掘商品评论识别刷单的订单。另外基于欺诈订单文本的特征，可以单独设计相关模型，这类定制化的模型通常会比通用模型有更好的效果。

### 2.3 序列挖掘
最近一段时间的反欺诈模型也有向序列挖掘发展的趋势。基于用户的历史浏览行为、点击偏好、设备使用偏好等，建立一些浅层神经网络抽取用户的行为指纹，当用户账户被盗时，通过分析用户操作行为指纹的改变及时识别账户异常。

### 整体来看，欺诈和反欺诈是一个动态博弈的过程，针对不同的欺诈模式，需要灵活使用不同的数据和模型进行防控。

[反欺诈(Fraud Detection)中所用到的机器学习模型有哪些？ - 京东白条的回答 - 知乎](https://www.zhihu.com/question/30508773/answer/206572913)

&nbsp;
## 3
### 3.1 背景 - 为什么反欺诈检测难度很高？
反欺诈项目很多情况下就是客户根本不知道什么是欺诈，什么不是。换句话说，诈骗的定义很模糊。

**往小了说，反诈骗似乎是一个二分类问题(binary classification)，但你仔细想想后会发现其实这是个多分类问题(multi-class classification)，
因为可以每种不同的诈骗都当做一种单独的类型。而单一类型的诈骗几乎是不存在的，且诈骗的手段日新月新总在变化**。

即使像银行还有保险公司这种常年和诈骗打交道的行业，也必须常常更新自己的检测手段，而不是把赌注压到同一个模型上。除此之外，欺诈检测一般还面临以下问题：</p><ul><li>大部分情况下数据是没有标签(label)的，各种成熟的监督学习(supervised learning)没有用武之地。</li><li>区分噪音(noise)和异常点(anomaly)时难度很大，甚至需要发挥一点点想象力和直觉。</li><li>紧接着上一点，当多种诈骗数据混合在一起，区分不同的诈骗类型更难。根本原因还是因为我们并不了解每一种诈骗定义。</li></ul><p>退一步说，即使我们真的有诈骗的历史数据，即在有标签的情况下用监督学习，也存在很大的风险。<b>用这样的历史数据学出的模型只能检测曾经出现过与历史诈骗相似的诈骗，而对于变种的诈骗和从未见过的诈骗，我们的模型将会无能为力</b>。<b>因此，在实际情况中，我不建议直接用任何监督学习，至少不能单纯依靠一个监督学习模型来奢求检测到所有的诈骗。</b></p><p>这就陷入了一个鸡生蛋蛋生鸡的死循环，因为没有历史标签和对诈骗的理解，我们无法做出能对诈骗细分的模型。因此我们一般使用无监督学习(unsupervised learning)，且需要领域专家(domain experts)也就是对这个行业非常了解的人来验证我们的预测，提供反馈，以便于及时的调整模型。</p>
### 3.2 反欺诈项目的操作顺序(1) - 可视化
<p>一般在拿到数据以后，我会推荐以下步骤进行分析。当然，一个答案很难包括所有常见的操作，仅仅是分享个人经验以供思考。</p><p><b>数据可视化 - 相关矩阵(Correlation Matrix) &amp; 多维尺度变换(Multidimensional Scaling)  。人是视觉动物，可以在第一时间“看到”数据中存在的问题。</b>因此，对于大部分反欺诈问题，我建议至少要做以下两个可视化尝试:</p><p><b>2.1. </b>首先对不同的特征(feature)做一个<b>相关矩阵分析并可视化</b>，<b>分析相关矩阵的目的是告诉我们特征两两之间的关系，以便于我们快速发现一些数据里面可能存在的问题。最重要的是帮助我们检查数据是否存在问题，</b>有没有什么违反常理的情况。</p><p>以我最近在写的文章为例（并不是反欺诈问题），对不同偶像团体是否能够继续走红进行预测。我们希望不同特征之间的两两关系符合尝试， 我在模型里面用了6个不同的特征并计算相关矩阵: </p>

<b>2.2 多维尺度变换(MDS)来直接可视化数据分布</b></p><p>我们都知道一般来说欺诈和正常数据应该“长得不一样”，那是否可以直接把它们画出来来分析。</p><p>然而，数据可视化往往都是二维或者三维的，但现实往往是成百上千维。即使我们把一个特征作为一个维度，我们最多也只能可视化三个维度。而<b>多维尺度变换(MDS)可以将高维的数据在二维或者三维的框架里面进行可视化，类似的数据点会更加接近。通过观察数据点的分布，我们可以直观的猜测数据是否有规律，是否存在潜在异常点。</b></p><p>以我最近做的一个项目为例，我们用MDS将一个8维的数据在2维上展示出来。我们似乎可以直观的看到一些近似线性的关系，以及一些看起来“很可疑”的点，我在图中标注了出来。</p>

<p>这样做的好处有两点:</p><ul><li>首先我们可以看到数据是否存在特定的特征，如果所有的点都是随机散乱分布，那我们的麻烦就大了。</li><li>我们似乎可以看到有一些离群的数据点，这些点可能是潜在的“欺诈”，也有可能只是噪音而已。<b>但我们可以向客户或者老板展示这个可视图，向他们证明项目有潜在的价值。</b></li></ul><p>如果在可视化中我们看到了一些规律，这让有信心继续往下做，进入建模阶段。多加一句，此处和主成分分析(PCA)也有异曲同工之妙。</p>

### 3.3 反欺诈项目的操作顺序(2) - 算法
<p>一般我们对欺诈检测做两种假设：</p><ol><li><b>时序相关(time dependent)。</b>对于时序相关的问题，我们假设欺诈的发生依赖于时间，通过时间序列分析，我们可以发现异常的地方。举例，假设一个人的信用卡平时1-11月每月消费2000美元，但12月突然消费了5000美元，此时时间就对我们的项目存在意义。</li><li><b>时序独立(time independent)。</b>对于时序独立的问题，我们假设每一个欺诈都是独立，和时间无关。于是在分析中，我们移除了时间这个特征，我们不再把时间作为一个分析轴或者影响欺诈发生的特征。</li></ol><p><b>3.1. 时间序列分析(time series analysis)</b></p><p>时间序列分析展开说是很大的话题，从简单的观察一个时间序列是否稳定(stability)到更复杂的看多个特征如何在时间上互相作用如 vector auto-regression(var)。</p><p>一般我们对时间序列重整使其稳定后，会进行一系列分析，最简单的就是观察什么时候出现反常的spike(即突然上升)。</p>

<p><b>3.2. 时间独立下的建模</b></p><p><b>3.2.1. 无监督学习</b></p><p>如果我们假设时间对于欺诈并没有影响，那么我们有很多无监督学习可以用来检测异常值。</p><ol><li>像某位答主提到的<b>Isolation Forest</b>就是一种非常稳定的算法，是周志华老师提出的。而且在Sklearn里面已经得到了实现。基本的原理就是一种集成学习，通过计算每个数据点需要多少次节点拆分(splitting)才能被划分到独立的空间。<b>异常点因为和其他正常点离得较远不大相似，因此更容易用很少的拆分就可以被划到独立的空间里面去。</b></li><li>各种<b>Density Based的聚类方法(CBLOF)</b>。此处需要注意，大家熟知的K-Means为原型的聚类，如K-Modes都不大适合用于异常值检测，因为其本身很容易受到异常值和噪音的扰动。</li><li>各种以K近邻(KNN)为原型的检测方法。从本质上说，和聚类方法是比较类似的。</li></ol><p><b>3.2.2. 统计学密度估计及分布测试</b></p><p>比较简单的做法可以尝试将数据拟合到假设的混合模型上(finite mixture models)，再通过统计学测试检查异常点、 一般不大推荐直接这么做，因为需要对于正常数据分布的深刻了解，才能做出对于数据分布的正确推断。</p><p><b>3.2.3. 监督学习</b></p><p>就像上文提到的，我不太建议直接用监督学习。当然，在特定场合下如果需要使用的话，比较出名的就是MetaCost框架，可以结合各种基础学习器使用。</p><p><b>3.3. 时间相关及独立的交叉验证</b></p><p>其实很多问题不是非此即彼，换句话说，时间独立和时间独立可能找到相似的异常点。在项目允许的情况下，我们大可以将两种时间假设都做一遍，之后求交集。若出现在交集中，我们对于该点是诈骗的信心会进一步上升。</p>

### 3.4 反欺诈项目的操作顺序(3) - 如何验证欺诈点？
<p>假设我们通过上面的无监督学习得到了一些“潜在的欺诈点”，我们可以做一些分析来验证它们是否真的是欺诈。<b>首先我必须声明，这种归纳是存在很大偏见的，但很难避免</b>。</p><p>举例，我们可以对比异常值数据作为样本(sample)与总体(population)的各项数据的统计值(如均值方差等)，从统计学上证明它们是有显著差异的。但有显著差异并不代表他们一定是欺诈，只能说明它们不同。</p><p>当我们从统计学上证明其存在显著差异后，我们就开始想要归纳潜在的欺诈原因。以某供货商的数据为例，我们发现一个产品的进货变多、退货变少，但单位收益却上升，这是有问题的。</p><p>于是我们就可以大胆的推测他的进货和退货不是同一种产品，即在退货时用了比较便宜商品但拿到了更多的退货钱。</p><p><b>把这个故事讲给领域专家以后，他们会支持、质疑、甚至反对这个看法。根据领域专家的反馈，我们可以不断的调整优化模型，期待发现更多的问题。有的时候，也可以直接叫领域专家来帮忙分析为什么一些数据可能是欺诈。</b></p>

### 3.5 总结 - 如何构建可行的欺诈检测方案？
<p>首先，我们必须先要认清一个残酷的现实: <b>单纯依靠机器学习模型来检测欺诈是愚蠢的。至少在现阶段我们不能单纯依靠纯粹的数据模型来做这一点。比较折中且可行的方法是做 混合模型(hybrid model)，也就是把人为规则和机器学习模型合二为一，一起来使用</b>。</p><p>首先我们通过对领域专家的访谈和对历史数据的分析，可以得到一些非常可靠的评判标准。以保险行业为例，如果一个人刚买短期保险没两天就意外身亡，这存在欺诈的风险就很高。<b>这样的标准或许从机器学习中可以学到，或许学不到。如果有成本更低方法做到更好的效果，不要迷信全自动模型。</b></p><p><b>总结来说，反欺诈模型难度很高，而且需要和领域专家一起协作才能有最好的结果。机器学习从业者千万不要闭门造车，试图自己靠调参就搞个大新闻。</b></p><p><b>我个人推荐的步骤是：</b></p><ol><li><b>对数据进行必要的可视化，如MDS</b></li><li><b>同时考虑时间是否是重要因素，如果是那么进行时序分析</b></li><li><b>用无监督学习得到一些可能的异常点，如Isolation Forests </b></li><li><b>通过统计学方法分析得到的异常点是否有显著的不同，有特征可供我们研究</b></li><li><b>归纳特征并构造一个故事，与领域专家共同验证故事的可靠性</b></li><li><b>重复1-5直到被派到下一个项目上搬砖，争取找到尽量多有效的欺诈</b></li><li><b>构造[规则+机器学习]的混合模型，进一步调参优化模型</b></li></ol><p>鉴于篇幅，很多有趣的做法都没法详谈，比如时间序列上的聚类和半监督异常检测，有兴趣的朋友可以继续深入挖掘。</p><p><b>*具体的学习方法可以参考我最近的文章：</b></p><ul><li><a href="https://www.zhihu.com/question/57072166/answer/280824223" class="internal">机器学习门下，有哪些在工业界应用较多，前景较好的小方向？</a></li><li><a href="https://www.zhihu.com/question/280696035/answer/417091151" class="internal">微调：数据挖掘中常见的『异常检测』算法有哪些？</a></li><li><a href="https://zhuanlan.zhihu.com/p/37132428" class="internal">微调：「异常检测」开源工具库推荐</a></li></ul></span></div>



[反欺诈(Fraud Detection)中所用到的机器学习模型有哪些？ - 微调的回答 - 知乎](https://www.zhihu.com/question/30508773/answer/205831957)

&nbsp;
## 4
### 反欺诈和风控领域主要存在的几个问题: 问题定义难、标注成本高、黑样本少或无，白样本存在噪声、异常原因不好查明、并且欺诈者手段在进化。

[反欺诈(Fraud Detection)中所用到的机器学习模型有哪些？ - 风浪的回答 - 知乎](https://www.zhihu.com/question/30508773/answer/202283983)

&nbsp;
## References
[反欺诈(Fraud Detection)中所用到的机器学习模型有哪些？](https://www.zhihu.com/question/30508773/answer/649480524)
